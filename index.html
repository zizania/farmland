<!DOCTYPE html>
<html>
<head>
  <script src="http://d3js.org/d3.v3.min.js"></script>
</head>
<body>
  <!-- <img src="./gmaps-sat.png"> -->
  <style>

.background {
  fill: none;
  pointer-events: all;
}

#map {
  display: block;
  margin: 0 auto;
}

#farmland-path {
  fill: #ccc;
  stroke: #aaa;
  stroke-width: 5px;
}

</style>
<body>
<script>

var farmland = {
  type: 'FeatureCollection',
  features: [{
    type: 'Feature',
    id: '01',
    properties: { name: 'Farmland' },
    geometry: {
      type: 'Polygon',
      coordinates: [
        [["25.07805671252648","35.30631286729119"],["25.07806208829361","35.30629461187726"],["25.07806745960464","35.30627637209146"],["25.07807416703231","35.30625359467052"],["25.07807952789954","35.30623539032224"],["25.07808622225384","35.30621265717831"],["25.07810231478726","35.3061969190605"],["25.07811839749746","35.3061811904911"],["25.07812910029075","35.30616425864068"],["25.07812502444473","35.3061391770969"],["25.07811962268277","35.30611865281377"],["25.0781088680279","35.30609694506343"],["25.07809679409593","35.30607977855645"],["25.0780807149202","35.30605691742833"],["25.07806733588872","35.30604429741609"],["25.07804595197284","35.30602028693321"],["25.07803260252769","35.30600769653832"],["25.07801392806395","35.3059939206275"],["25.07798993993455","35.30597896330292"],["25.07796996287016","35.30596970080371"],["25.07795666769917","35.30595715322713"],["25.07793806193447","35.30594342521363"],["25.07791416910662","35.30592873634064"],["25.07789290845174","35.30592408158204"],["25.0778743598471","35.30591066800334"],["25.07784915832612","35.30590047769727"],["25.07783063006146","35.30588707675719"],["25.07780409873324","35.3058812732356"],["25.07778028760939","35.30586672391088"],["25.07776179073088","35.30585334170349"],["25.07774589178991","35.30584986635714"],["25.07771681790014","35.30583417881538"],["25.07768640744237","35.30582286940831"],["25.07766659477798","35.30581388797997"],["25.07764810465267","35.3058008169671"],["25.07762961496977","35.30578774629267"],["25.07760976340229","35.30577906148124"],["25.0775912734882","35.3057659907204"],["25.07757141983353","35.30575730473079"],["25.07756217502885","35.3057507691741"],["25.07752109498873","35.30573777877554"],["25.07750654215728","35.30573016641464"],["25.07747606546486","35.30571932436035"],["25.07745089261648","35.30570955737632"],["25.07743633626657","35.30570194329521"],["25.07741118458808","35.30569210883036"],["25.07740194497262","35.30568555312666"],["25.07736893122264","35.30566478163421"],["25.07733456319506","35.30564835489178"],["25.07731079357569","35.30563414186992"],["25.07728566701221","35.30562427133954"],["25.07726583871939","35.30561550716294"],["25.07724207560901","35.30560129750017"],["25.07721695407086","35.30559142913523"],["25.07719849113989","35.30557832730235"],["25.07718002992776","35.30556522656685"],["25.0771484077929","35.30554013429627"],["25.07712465665742","35.30552593214263"],["25.0770995460203","35.30551606891307"],["25.07706914268516","35.30550510130397"],["25.07704267234545","35.30549957650675"],["25.07702286022264","35.30549081986265"],["25.07699109854329","35.30548419066525"],["25.0769657920156","35.30547453353235"],["25.07693356621224","35.30546834281376"],["25.07690807418571","35.30545881953828"],["25.07688117495272","35.30545365025433"],["25.07684347908087","35.30544640602007"],["25.0768219190817","35.30544226274246"],["25.07680034495331","35.30543811670833"],["25.07678015152494","35.30542960124252"],["25.07674373739938","35.3054179634788"],["25.07671269414875","35.30540735393014"],["25.07669384893124","35.30539444749958"],["25.0766790086711","35.30538694934597"],["25.07665874502408","35.30537840407883"],["25.07664127508179","35.30536110813762"],["25.076634641814","35.30534589859278"],["25.07661996939761","35.30531984682819"],["25.07660650520583","35.30530795410476"],["25.0765958463649","35.30528731318262"],["25.07658237459432","35.30527541177405"],["25.07656487404261","35.30525807951351"],["25.07654590065362","35.30524514110143"],["25.07652141884707","35.30523116544678"],["25.07650236788558","35.30521823324298"],["25.07648330427461","35.30520529224276"],["25.07646014398255","35.30518692334611"],["25.07643967645092","35.30517832478945"],["25.07642057099726","35.30516535629555"],["25.07640145247712","35.30515237919487"],["25.07638232125795","35.30513939331427"],["25.07635770031071","35.30512533291438"],["25.0763385400921","35.30511232805058"],["25.07631936684626","35.30509931457753"],["25.07629880029141","35.30509066447298"],["25.0762795290213","35.30507765672446"],["25.07625882960376","35.30506902334651"],["25.07623950276838","35.3050560037913"],["25.07621877005089","35.3050473547595"],["25.0761938737855","35.30503324601823"],["25.07617171084977","35.30502896406673"],["25.07614676751334","35.30501483292112"],["25.0761245635054","35.30501053918049"],["25.07610513131573","35.30499746128692"],["25.07608428741488","35.30498876465946"],["25.07605785867325","35.30497898221022"],["25.07603280111957","35.30496479360636"],["25.07601329634532","35.30495167331004"],["25.07599935782968","35.30493962706826"],["25.07597564130471","35.30492100085343"],["25.07596867030783","35.3049056233446"],["25.07595610736854","35.30488915006472"],["25.0759449396366","35.30486826462066"],["25.07594495585226","35.30484955942703"],["25.07594916328556","35.30483635193817"],["25.07595617453699","35.30481434199675"],["25.0759743637962","35.30479453744886"],["25.07598555585468","35.30477804064497"],["25.07599814522741","35.30475715143461"],["25.07601491062732","35.30474177249222"],["25.07602190984124","35.30471979153475"],["25.0760289081816","35.30469781385528"],["25.07603450619053","35.30468023397318"],["25.07604150275172","35.30465826220351"],["25.07605824678375","35.30464291898554"],["25.07606941165591","35.30462646715348"],["25.07608197050425","35.30460563019505"],["25.07609869334111","35.30459031112223"],["25.07611124084171","35.30456949028866"],["25.07612245612971","35.3045530660931"],["25.07612813672709","35.30453552416769"],["25.07614078607597","35.30451472987504"],["25.07614646207042","35.30449719870469"],["25.07615910245373","35.30447642145937"],["25.07616890122236","35.30446441305422"],["25.0761883845246","35.3044403997505"],["25.07620634470903","35.30442076618289"],["25.07621601462052","35.3044087637005"],["25.07622845196887","35.30438800803422"],["25.07624500965469","35.30437277275411"],["25.07625467020907","35.30436078182831"],["25.07627948684426","35.30433794817107"],["25.07629603204043","35.30432273623226"],["25.07631677497266","35.30431306202431"],["25.07632785192177","35.30429673110404"],["25.07634995974834","35.30428270412528"],["25.0763720506453","35.3042686881515"],["25.07639273884402","35.30425904619471"],["25.07641479728413","35.30424504938474"],["25.07643406976431","35.30423978349621"],["25.07645747980233","35.30422144595371"],["25.07648497809905","35.30420863380093"],["25.07651106796516","35.30420018769688"],["25.07653165447276","35.30419059424866"],["25.07655360652079","35.30417665752031"],["25.07657007052264","35.3041615739135"],["25.07658514712005","35.30415084606703"],["25.07660705848815","35.30413693725892"],["25.07662895351378","35.30412303882972"],["25.07665083168798","35.30410915078764"],["25.07667269346231","35.3040952734327"],["25.0766931641816","35.30408574487843"],["25.07671499371928","35.30407188654916"],["25.07673680658787","35.30405803873021"],["25.07675723125889","35.30404853430559"],["25.07677221078574","35.3040378701726"],["25.07680483086521","35.30402638391883"],["25.07681978565188","35.30401573439264"],["25.07684556680753","35.30400742767465"],["25.07686591248892","35.3039979597631"],["25.0768916506884","35.30398966826441"],["25.07691736467993","35.30398138442356"],["25.0769336254572","35.30396644989543"],["25.07695527148679","35.30395269518577"],["25.07697553812857","35.30394326573515"],["25.07699032463061","35.30393260633844"],["25.07701175978386","35.30391873447311"],["25.07703318780101","35.30390486753399"],["25.07705460869834","35.30389100536367"],["25.07707332044117","35.30388578680773"],["25.07709471090695","35.30387191623883"],["25.07711473879139","35.30386236164914"],["25.07713610155376","35.30384848155104"],["25.07715745903177","35.30383460491551"],["25.0771774702914","35.30382505908869"],["25.07719881700507","35.30381118900474"],["25.07721483288539","35.30379617509026"],["25.07723617089276","35.3037823113083"],["25.07725616228819","35.30377277691731"],["25.07727748952916","35.30375891975928"],["25.07729746993295","35.30374939106253"],["25.0773241021886","35.30373669022426"],["25.07733741464123","35.30373034164777"],["25.07735737876929","35.30372082061033"],["25.07738264773927","35.30371245337748"],["25.07741321392311","35.3037052400467"],["25.07742650934456","35.30369889848999"],["25.07745839567547","35.30368737061808"],["25.07747833853086","35.30367789977895"],["25.07749829324236","35.30366848445565"],["25.07751958587688","35.30365477233323"],["25.07754086842106","35.3036410667618"],["25.07756214090435","35.3036273676768"],["25.07758205749573","35.30361797289218"],["25.07760331034209","35.30360428525454"],["25.07762455310598","35.3035906043906"],["25.0776510687815","35.30357809909729"],["25.0776656644254","35.30356755560715"],["25.07768549922724","35.30355794121656"],["25.07770801466785","35.30353968193886"],["25.07773053239231","35.30352142094917"],["25.07775170964707","35.3035074710354"],["25.07777288836815","35.30349352001421"],["25.07779406857887","35.30347956816691"],["25.07780863714317","35.303468828383"],["25.07783509004853","35.30345597542121"],["25.07786020066469","35.30344743515396"],["25.07788396840335","35.30344320876965"],["25.07791166239067","35.30344439657511"],["25.07793933756826","35.30344578919664"],["25.07796039297956","35.30345037179788"],["25.07798144111349","35.30345495273753"],["25.07801299972416","35.30346182113563"],["25.07803928628183","35.30346754229166"],["25.07806030742158","35.30347211746232"],["25.07808657375406","35.30347783409391"],["25.078107578811","35.30348240567405"],["25.07811276086752","35.3035016802871"],["25.078123194322","35.30352209923808"],["25.07813362882188","35.30354252009506"],["25.07814672071977","35.30355444061787"],["25.07815848389271","35.30357061112421"],["25.07817024707209","35.30358678164772"],["25.07818068321526","35.30360720482341"],["25.07818719896636","35.30362223885481"],["25.07819238879497","35.30364152905759"],["25.07819100400225","35.30366394299967"],["25.07818569583304","35.30368097170275"],["25.0781790579999","35.3037022657125"],["25.07817367893387","35.30371948251904"],["25.07817355949152","35.30373781071282"],["25.07816682973231","35.30375934577217"],["25.0781614464168","35.3037765719524"],["25.07815606365888","35.30379379672976"],["25.07815594503595","35.30381211785416"],["25.07815448110884","35.30383474247883"],["25.07816097146241","35.30384985279618"],["25.07817137887021","35.30387036393187"],["25.07817652248173","35.30388977524777"],["25.0781816654186","35.30390918440866"],["25.07818020036668","35.30393179751304"],["25.0781853425496","35.30395120231168"],["25.0781904842732","35.30397060532049"],["25.07818644817834","35.30398351081607"],["25.07819550524203","35.30400830857489"],["25.07819930034064","35.30403200626121"],["25.07820444033018","35.30405140112001"],["25.07821483978143","35.30407189004345"],["25.07821471854782","35.30409018444836"],["25.07822377110435","35.30411496789913"],["25.07821973546404","35.30412786387643"],["25.07822352796365","35.30415154668905"],["25.07822340636359","35.30416983344922"],["25.07822462978214","35.30418382108525"],["25.07823502456756","35.30420429575558"],["25.0782401603036","35.30422367278189"],["25.07824529548361","35.30424304759781"],["25.07825043033378","35.30426242081229"],["25.07826082148851","35.30428288670279"],["25.07826729996346","35.30429796089811"],["25.07827634416403","35.30432271720923"],["25.07828673235181","35.30434317655343"],["25.07829051836653","35.30436683237057"],["25.07828904866508","35.30438939093788"],["25.07828892409779","35.30440765483658"],["25.07829405430008","35.30442701071418"],["25.07829392939043","35.30444527087785"],["25.07829380462468","35.30446352946554"],["25.07830418793776","35.30448397339901"],["25.07830931634067","35.3045033216777"],["25.07831969787882","35.30452376150055"],["25.07832616993677","35.30453881646377"],["25.07833520442441","35.30456354092811"],["25.07834564299571","35.30458397117233"],["25.0783561075553","35.3046044041538"],["25.078366644946","35.30462484388224"],["25.07836792061926","35.30463880978056"],["25.07837846406773","35.30465926427787"],["25.07838370471984","35.30467862836417"],["25.07839029057442","35.3046937062964"],["25.07839419098415","35.30471737457891"],["25.07839943643269","35.30473675676922"],["25.07840333935469","35.30476043874914"],["25.07840858799977","35.30477983342534"],["25.0784138381585","35.30479923430268"],["25.07841774493007","35.30482293653317"],["25.07841768124209","35.30484123402235"],["25.07841627226771","35.30486382970193"],["25.07841620845915","35.30488213231369"],["25.07841614461108","35.30490043727685"],["25.07841473524886","35.30492304136161"],["25.07841601684675","35.30493705490735"],["25.07841326172693","35.30496396074952"],["25.07840787959915","35.30498114731832"],["25.0784131336132","35.3050005937678"],["25.07841172370397","35.30502321138313"],["25.07841165960063","35.30504153429482"],["25.0784129413047","35.30505556186289"],["25.07841018500294","35.30508248517466"],["25.07841544163054","35.30510195555686"],["25.07841140262323","35.30511485054382"],["25.07841531356449","35.30513862731847"],["25.07841659624894","35.3051526679609"],["25.07841383896573","35.30517960810631"],["25.07841512167139","35.30519365356714"],["25.07841505762711","35.30521200062506"],["25.07841897088054","35.30523580206354"],["25.07842426347063","35.30525534403017"],["25.07841903690327","35.30527273284815"],["25.07842448757544","35.30529247249392"],["25.07842863578911","35.30531658621484"],["25.07843408862805","35.30533635689113"],["25.07843416858384","35.30535493118822"],["25.07843960809842","35.30537470929459"],["25.07844373217079","35.3053988575389"],["25.07844381516914","35.30541747355829"],["25.07845331309234","35.30544286288484"],["25.07844802872363","35.30546030428319"],["25.07845885822885","35.30548137452502"],["25.07846300016116","35.30550562428441"],["25.07847252671671","35.30553111208418"],["25.07847932475894","35.30554666278948"],["25.07849019313428","35.30556782246219"],["25.07849700440398","35.30558340177874"],["25.07850249763162","35.30560337529026"],["25.07850667208852","35.30562775141073"],["25.07850545071265","35.30565091776453"],["25.07850555324951","35.30566970979639"],["25.07850565566426","35.30568851332671"],["25.07850035467627","35.30570608791547"],["25.07850453502373","35.30573055283653"],["25.07850596335898","35.30574499361113"],["25.07849933089072","35.30576699628751"],["25.07849402253323","35.30578460586731"],["25.07849279388341","35.30580788163952"],["25.07849697678478","35.30583243213474"],["25.07849707699009","35.30585133272145"],["25.07850259414713","35.30587150897497"],["25.07851896083283","35.30589423710627"],["25.07853800771368","35.30590815222733"],["25.07855297176306","35.30591638735661"],["25.07858426569203","35.30592845005717"],["25.07860471271004","35.30593797932831"],["25.0786319331453","35.30594431428641"],["25.07865372895121","35.30594938246583"],["25.07868370312362","35.30594692435847"],["25.07871370935992","35.30594446373154"],["25.0787354639953","35.30593058841277"],["25.07875851799442","35.30591221764981"],["25.07876796915682","35.30590017346682"],["25.07879103008481","35.30588179682893"],["25.07880861094113","35.30586214513337"],["25.0788316805179","35.30584376089192"],["25.07884794377219","35.30582854339841"],["25.07886288923322","35.30581776151896"],["25.07888597269496","35.3057993659601"],["25.07890897066853","35.30578086538923"],["25.07893062030107","35.30576676375364"],["25.07895227275971","35.30575266043662"],["25.07896843472275","35.30573731522201"],["25.07898459523144","35.30572197150448"],["25.0790007543513","35.30570662921555"],["25.07901141544775","35.3056900536587"],["25.07903727772258","35.30568163362419"],["25.07906960063501","35.30568842897612"],["25.07908984527541","35.30569739561687"],["25.07910884023283","35.30571084678281"],["25.07911583338014","35.30572654424167"],["25.07912157686008","35.30574673918053"],["25.07912194245075","35.30576582596843"],["25.07911692404827","35.30578380259171"],["25.07911064579882","35.30580629174688"],["25.07910561915092","35.30582429775138"],["25.07909268094991","35.30585020560805"],["25.07907685670268","35.30586599153366"],["25.0790664165324","35.30588291521097"],["25.07905596864564","35.30589985106573"],["25.07904137996812","35.30591115171408"],["25.07901829873309","35.3059297605418"],["25.07899637430673","35.30594371570865"],["25.07897845179505","35.30594431567643"],["25.07894680353322","35.3059512097977"],["25.07892204957544","35.30595495229136"],["25.07890146913696","35.30596438462052"],["25.07887954808806","35.30597822896087"],["25.0788576389511","35.30599206592155"],["25.07883574157143","35.30600589553617"],["25.07881385602554","35.30601971767636"],["25.07879746863603","35.30603481407064"],["25.0787756025837","35.30604862236805"],["25.07875787525956","35.30606812109622"],["25.07874698404191","35.30608448833878"],["25.07873609354325","35.30610085421554"],["25.07871972858433","35.30611592831417"],["25.07869789756061","35.30612970612687"],["25.07867607806633","35.30614347645279"],["25.07866108720877","35.30615412282758"],["25.07863653452677","35.30615776771241"],["25.07861470859561","35.30615259551627"],["25.07858474838169","35.30615494549504"],["25.07856042142902","35.30615892547009"],["25.07854037786323","35.30616901272928"],["25.07852032657726","35.30617910380823"],["25.07850026720503","35.30618919896543"],["25.07848430087259","35.30620504643814"],["25.07846292598915","35.30621971334575"],["25.07844153765726","35.30623438947505"],["25.07842553473796","35.30625026840145"],["25.07841082523246","35.30626158763183"],["25.07839070872309","35.30627171706257"],["25.07837058430475","35.30628185044034"],["25.0783530745308","35.30628283221049"],["25.07831800522431","35.30628461299636"],["25.07829507231606","35.30628427772341"],["25.07827082405073","35.30628850847268"],["25.07824525273403","35.30629730595475"],["25.078226403624","35.30630276265892"],["25.07820082695002","35.30631156189326"],["25.07818064278124","35.3063215903178"],["25.0781617881259","35.30632704887594"],["25.07813753855672","35.30633127901549"],["25.07811191864845","35.30632056818384"],["25.07809709364795","35.3063123194075"],["25.0780647836001","35.30630496309843"],["25.07805671252648","35.30631286729119"],["25.07805671252648","35.30631286729119"]]
      ]
    }
  }]
}

var width  = window.innerWidth - 50
  , height = window.innerHeight - 50

var projection = d3.geo.mercator()
  .center([25.077496, 35.304934])
  .scale(width * 5353)

projection.translate([width / 2, height / 2])

var zoom = d3.behavior.zoom()
  .translate(projection.translate())
  .scale(projection.scale())
  .on('zoom', redraw)

var svg = d3.select('body').append('svg')
  .attr('id', 'map')
  .attr('width', width)
  .attr('height', height)
  .call(zoom)

svg.append('defs')

svg.append('rect')
  .attr('width', width)
  .attr('height', height)
  .attr('opacity', '0')

var path = d3.geo.path().projection(projection)


var group = svg.append('g')
  .attr('id', 'farmland')


group.append('path')
  .attr('id', 'farmland-path')
  .datum(farmland)
  .attr('d', path)

var trees = [{"id":"0","coordinates":["25.0760697591711","35.30489317784379"]},{"id":"1","coordinates":["25.07605527359619","35.30478658234575"]},{"id":"2","coordinates":["25.07615625445991","35.30484582797083"]},{"id":"3","coordinates":["25.07609317406333","35.30467076713663"]},{"id":"4","coordinates":["25.07621746753978","35.30472548845992"]},{"id":"5","coordinates":["25.07617655184536","35.30464241100839"]},{"id":"6","coordinates":["25.0762767435447","35.30457947356676"]},{"id":"7","coordinates":["25.07616202630549","35.30456097455924"]},{"id":"8","coordinates":["25.07625494562389","35.30448591305209"]},{"id":"9","coordinates":["25.0763463902261","35.30444748816696"]},{"id":"10","coordinates":["25.0763354011178","35.3046686860086"]},{"id":"11","coordinates":["25.07637765404165","35.30454398760573"]},{"id":"12","coordinates":["25.07620832402617","35.3049525263827"]},{"id":"13","coordinates":["25.07623291032946","35.30482219815561"]},{"id":"14","coordinates":["25.07642231572905","35.3046442270628"]},{"id":"15","coordinates":["25.07635286814978","35.30478146367739"]},{"id":"16","coordinates":["25.07640721764334","35.30487154099033"]},{"id":"17","coordinates":["25.0765032724979","35.30482060318912"]},{"id":"18","coordinates":["25.07642957757005","35.30498154662015"]},{"id":"19","coordinates":["25.07653038427588","35.304929955471"]},{"id":"20","coordinates":["25.07632806739201","35.30503720591093"]},{"id":"21","coordinates":["25.07651839446195","35.3045905493499"]},{"id":"22","coordinates":["25.07647792747489","35.30450153689096"]},{"id":"23","coordinates":["25.07642840360294","35.30441308003967"]},{"id":"24","coordinates":["25.0765087997815","35.30436530925711"]},{"id":"25","coordinates":["25.07648256581664","35.30427249866985"]},{"id":"26","coordinates":["25.07639941071078","35.3043250747811"]},{"id":"27","coordinates":["25.07656966370718","35.30422373708169"]},{"id":"28","coordinates":["25.07665145056619","35.3042003204968"]},{"id":"29","coordinates":["25.07675243281202","35.30412679901124"]},{"id":"30","coordinates":["25.07685480323341","35.30408832916157"]},{"id":"31","coordinates":["25.07696084943657","35.30404646449373"]},{"id":"32","coordinates":["25.07704787537521","35.30399484151442"]},{"id":"33","coordinates":["25.07712982901213","35.30393657792617"]},{"id":"34","coordinates":["25.07725075338393","35.30389526604476"]},{"id":"35","coordinates":["25.07734492870105","35.30384774286864"]},{"id":"36","coordinates":["25.07741758052417","35.3038182882382"]},{"id":"37","coordinates":["25.0775405367907","35.30375316455564"]},{"id":"38","coordinates":["25.07763284436174","35.30368914751632"]},{"id":"39","coordinates":["25.07776370622421","35.30364506569493"]},{"id":"40","coordinates":["25.07770127802927","35.30356756922124"]},{"id":"41","coordinates":["25.07783741012896","35.30356456283472"]},{"id":"42","coordinates":["25.07803973944914","35.30352267891691"]},{"id":"43","coordinates":["25.07812008662889","35.30356303009795"]},{"id":"44","coordinates":["25.07799360249995","35.30360313409483"]},{"id":"45","coordinates":["25.07780406019982","35.30369316940518"]},{"id":"46","coordinates":["25.07790992317029","35.30365987559743"]},{"id":"47","coordinates":["25.07796223404644","35.30370000918126"]},{"id":"48","coordinates":["25.07810985597008","35.30364172064585"]},{"id":"49","coordinates":["25.07805092789848","35.3036670749177"]},{"id":"50","coordinates":["25.07783517535279","35.3037442038152"]},{"id":"51","coordinates":["25.07770731511349","35.30376430139179"]},{"id":"52","coordinates":["25.07760931841836","35.30381484638394"]},{"id":"53","coordinates":["25.07749332028888","35.30385555365602"]},{"id":"54","coordinates":["25.07739865562373","35.30391345235603"]},{"id":"55","coordinates":["25.07730322558987","35.30395060996628"]},{"id":"56","coordinates":["25.07720749919719","35.30400905760856"]},{"id":"57","coordinates":["25.07711123689145","35.30406783224923"]},{"id":"58","coordinates":["25.07701884574436","35.30411616541143"]},{"id":"59","coordinates":["25.07690723593223","35.30415470709094"]},{"id":"60","coordinates":["25.0768258072844","35.30421425322266"]},{"id":"61","coordinates":["25.07670757618985","35.30425368372423"]},{"id":"62","coordinates":["25.07660649778196","35.3043146029727"]},{"id":"63","coordinates":["25.07656349939356","35.30444707979419"]},{"id":"64","coordinates":["25.07665133947951","35.30440034256245"]},{"id":"65","coordinates":["25.0767932592787","35.30434853788714"]},{"id":"66","coordinates":["25.07687509216319","35.30430984270159"]},{"id":"67","coordinates":["25.07697895594261","35.3042563509619"]},{"id":"68","coordinates":["25.07707188019601","35.3042038792528"]},{"id":"69","coordinates":["25.07716866144013","35.30414091151631"]},{"id":"70","coordinates":["25.07726303255345","35.30408931754507"]},{"id":"71","coordinates":["25.07736301946357","35.30405162033527"]},{"id":"72","coordinates":["25.07748403181004","35.30399954452005"]},{"id":"73","coordinates":["25.0776385209476","35.30392953991176"]},{"id":"74","coordinates":["25.07774533092337","35.30389928941381"]},{"id":"75","coordinates":["25.07780810195149","35.30383879309231"]},{"id":"76","coordinates":["25.0779318206766","35.30381871667173"]},{"id":"77","coordinates":["25.07808838390259","35.30376722958181"]},{"id":"78","coordinates":["25.07803432231849","35.30383106287521"]},{"id":"79","coordinates":["25.07660335560401","35.30454623610704"]},{"id":"80","coordinates":["25.07672988749881","35.30447755414913"]},{"id":"81","coordinates":["25.07682975313575","35.30443457344097"]},{"id":"82","coordinates":["25.07692792901875","35.3043776156331"]},{"id":"83","coordinates":["25.07704537788439","35.30432842844785"]},{"id":"84","coordinates":["25.07715802844952","35.30427435457459"]},{"id":"85","coordinates":["25.07646859942897","35.3047193257112"]},{"id":"86","coordinates":["25.07655618205055","35.30468001185149"]},{"id":"87","coordinates":["25.07667360834286","35.30462961897543"]},{"id":"88","coordinates":["25.07678189364158","35.30456336999037"]},{"id":"89","coordinates":["25.07688405552036","35.30451362032594"]},{"id":"90","coordinates":["25.07654427127638","35.30517161227424"]},{"id":"91","coordinates":["25.0765039774071","35.30508856963115"]},{"id":"92","coordinates":["25.07659471565028","35.30504725280877"]},{"id":"93","coordinates":["25.07666042305665","35.30487120525505"]},{"id":"94","coordinates":["25.07661618209252","35.30476934970407"]},{"id":"95","coordinates":["25.07672140071745","35.30473555318058"]},{"id":"96","coordinates":["25.07682719049695","35.30468354672689"]},{"id":"97","coordinates":["25.07695513471855","35.30462863999046"]},{"id":"98","coordinates":["25.07698974587792","35.30447907402888"]},{"id":"99","coordinates":["25.07710171171265","35.30441405273586"]},{"id":"100","coordinates":["25.07720779880858","35.30436462701373"]},{"id":"101","coordinates":["25.07728150399014","35.30432067887042"]},{"id":"102","coordinates":["25.07725058327716","35.30421543823624"]}]


var treesGroup = group.append('g').attr('id', 'trees-group')

function treesCircles() {
  treesGroup
    .selectAll('circle').data(trees)
    .enter().append('circle')
    .attr('class', 'tree')
    .attr('id', function (c) { debugger; return c.id })
    .attr('r', 5)
}

function treesBig() {
  treesGroup
    .selectAll('image').data(trees)
    .enter().append('image')
    .attr('id', function (c) { return c.id })
    .attr('class', 'tree')
    .attr('xlink:href', './tree.svg')
}

function swapTrees() {
  treesGroup
    .selectAll('*').remove()

  if (zoom.images) {
    treesBig()
  }
  else {
    treesCircles()
  }
}

function positionTreeImage(tree) {
  var xy    = projection(tree.coordinates)
    , scale = zoom.scale()

  var image = d3.select(this)
  
  image.attr('width', scale / 700000)
  image.attr('height', scale / 700000)

  image.attr('x', xy[0] - image.attr('width') / 2)
  image.attr('y', xy[1] - image.attr('height') / 2)
}

function positionTreeCircle(tree) {
  var xy    = projection(tree.coordinates)
    , scale = zoom.scale()

  var circle = d3.select(this)
  
  circle.attr('cx', xy[0])
  circle.attr('cy', xy[1])
}

treesCircles()
redraw()

zoom.images = false

function redraw() {
  var scale = zoom.scale()

  projection
    .translate(zoom.translate())
    .scale(scale)

  // force re-projection
  group.selectAll('path').attr('d', path)

  var trees = group.selectAll('.tree')

  if (zoom.images) {
    trees.each(positionTreeImage)
  }
  else {
    trees.each(positionTreeCircle)
  }

  if (scale > 39737183 && !zoom.images) {
    zoom.images = true
    swapTrees()
    redraw()
  }
  else if (zoom.images && scale < 39737183) {
    zoom.images = false
    swapTrees()
    redraw()
  }
}
</script>
</body>
</html>

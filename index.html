<!DOCTYPE html>
<html>
<head>
  <script src="http://d3js.org/d3.v3.min.js"></script>
</head>
<body>
  <!-- <img src="./gmaps-sat.png"> -->
  <style>

.background {
  fill: none;
  pointer-events: all;
}

#map {
  display: block;
  margin: 0 auto;
}

#farmland-path {
  fill: #ccc;
  stroke: #aaa;
  stroke-width: 5px;
}

</style>
<body>
<script>

var farmland = {
  type: 'FeatureCollection',
  features: [{
    type: 'Feature',
    id: '01',
    properties: { name: 'Farmland' },
    geometry: {
      type: 'Polygon',
      coordinates: [
        [ [25.077871, 35.303472], [25.076187, 35.304391], [25.075897, 35.304890], [25.077935, 35.306011], [25.078139, 35.306178], [25.078043, 35.306335], [25.078965, 35.305915], [25.079008, 35.305696], [25.078601, 35.305950], [25.078450, 35.305906], [25.078472, 35.305617], [25.078386, 35.305486], [25.078322, 35.304645], [25.078214, 35.304251], [25.078118, 35.303542], [25.077871, 35.303472] ]
      ]
    }
  }]
}

var width  = window.innerWidth - 50
  , height = window.innerHeight - 50

var projection = d3.geo.mercator()
  .center([25.077496, 35.304934])
  .scale(10000000)

projection.translate([width / 2, height / 2])

var svg = d3.select('body').append('svg')
  .attr('id', 'map')
  .attr('width', width)
  .attr('height', height)
  .call(d3.behavior.zoom()
      .translate(projection.translate())
      .scale(projection.scale())
      .on("zoom", redraw))

svg.append('rect')
  .attr('width', width)
  .attr('height', height)
  .attr('opacity', '0')

var path = d3.geo.path().projection(projection)


var group = svg.append('g')
  .attr('id', 'farmland')


group.append('path')
  .attr('id', 'farmland-path')
  .datum(farmland)
  .attr('d', path)

var trees = [{"id":"0","coordinates":["25.0760697591711","35.30489317784379"]},{"id":"1","coordinates":["25.07605527359619","35.30478658234575"]},{"id":"2","coordinates":["25.07615625445991","35.30484582797083"]},{"id":"3","coordinates":["25.07609317406333","35.30467076713663"]},{"id":"4","coordinates":["25.07621746753978","35.30472548845992"]},{"id":"5","coordinates":["25.07617655184536","35.30464241100839"]},{"id":"6","coordinates":["25.0762767435447","35.30457947356676"]},{"id":"7","coordinates":["25.07616202630549","35.30456097455924"]},{"id":"8","coordinates":["25.07625494562389","35.30448591305209"]},{"id":"9","coordinates":["25.0763463902261","35.30444748816696"]},{"id":"10","coordinates":["25.0763354011178","35.3046686860086"]},{"id":"11","coordinates":["25.07637765404165","35.30454398760573"]},{"id":"12","coordinates":["25.07620832402617","35.3049525263827"]},{"id":"13","coordinates":["25.07623291032946","35.30482219815561"]},{"id":"14","coordinates":["25.07642231572905","35.3046442270628"]},{"id":"15","coordinates":["25.07635286814978","35.30478146367739"]},{"id":"16","coordinates":["25.07640721764334","35.30487154099033"]},{"id":"17","coordinates":["25.0765032724979","35.30482060318912"]},{"id":"18","coordinates":["25.07642957757005","35.30498154662015"]},{"id":"19","coordinates":["25.07653038427588","35.304929955471"]},{"id":"20","coordinates":["25.07632806739201","35.30503720591093"]},{"id":"21","coordinates":["25.07651839446195","35.3045905493499"]},{"id":"22","coordinates":["25.07647792747489","35.30450153689096"]},{"id":"23","coordinates":["25.07642840360294","35.30441308003967"]},{"id":"24","coordinates":["25.0765087997815","35.30436530925711"]},{"id":"25","coordinates":["25.07648256581664","35.30427249866985"]},{"id":"26","coordinates":["25.07639941071078","35.3043250747811"]},{"id":"27","coordinates":["25.07656966370718","35.30422373708169"]},{"id":"28","coordinates":["25.07665145056619","35.3042003204968"]},{"id":"29","coordinates":["25.07675243281202","35.30412679901124"]},{"id":"30","coordinates":["25.07685480323341","35.30408832916157"]},{"id":"31","coordinates":["25.07696084943657","35.30404646449373"]},{"id":"32","coordinates":["25.07704787537521","35.30399484151442"]},{"id":"33","coordinates":["25.07712982901213","35.30393657792617"]},{"id":"34","coordinates":["25.07725075338393","35.30389526604476"]},{"id":"35","coordinates":["25.07734492870105","35.30384774286864"]},{"id":"36","coordinates":["25.07741758052417","35.3038182882382"]},{"id":"37","coordinates":["25.0775405367907","35.30375316455564"]},{"id":"38","coordinates":["25.07763284436174","35.30368914751632"]},{"id":"39","coordinates":["25.07776370622421","35.30364506569493"]},{"id":"40","coordinates":["25.07770127802927","35.30356756922124"]},{"id":"41","coordinates":["25.07783741012896","35.30356456283472"]},{"id":"42","coordinates":["25.07803973944914","35.30352267891691"]},{"id":"43","coordinates":["25.07812008662889","35.30356303009795"]},{"id":"44","coordinates":["25.07799360249995","35.30360313409483"]},{"id":"45","coordinates":["25.07780406019982","35.30369316940518"]},{"id":"46","coordinates":["25.07790992317029","35.30365987559743"]},{"id":"47","coordinates":["25.07796223404644","35.30370000918126"]},{"id":"48","coordinates":["25.07810985597008","35.30364172064585"]},{"id":"49","coordinates":["25.07805092789848","35.3036670749177"]},{"id":"50","coordinates":["25.07783517535279","35.3037442038152"]},{"id":"51","coordinates":["25.07770731511349","35.30376430139179"]},{"id":"52","coordinates":["25.07760931841836","35.30381484638394"]},{"id":"53","coordinates":["25.07749332028888","35.30385555365602"]},{"id":"54","coordinates":["25.07739865562373","35.30391345235603"]},{"id":"55","coordinates":["25.07730322558987","35.30395060996628"]},{"id":"56","coordinates":["25.07720749919719","35.30400905760856"]},{"id":"57","coordinates":["25.07711123689145","35.30406783224923"]},{"id":"58","coordinates":["25.07701884574436","35.30411616541143"]},{"id":"59","coordinates":["25.07690723593223","35.30415470709094"]},{"id":"60","coordinates":["25.0768258072844","35.30421425322266"]},{"id":"61","coordinates":["25.07670757618985","35.30425368372423"]},{"id":"62","coordinates":["25.07660649778196","35.3043146029727"]},{"id":"63","coordinates":["25.07656349939356","35.30444707979419"]},{"id":"64","coordinates":["25.07665133947951","35.30440034256245"]},{"id":"65","coordinates":["25.0767932592787","35.30434853788714"]},{"id":"66","coordinates":["25.07687509216319","35.30430984270159"]},{"id":"67","coordinates":["25.07697895594261","35.3042563509619"]},{"id":"68","coordinates":["25.07707188019601","35.3042038792528"]},{"id":"69","coordinates":["25.07716866144013","35.30414091151631"]},{"id":"70","coordinates":["25.07726303255345","35.30408931754507"]},{"id":"71","coordinates":["25.07736301946357","35.30405162033527"]},{"id":"72","coordinates":["25.07748403181004","35.30399954452005"]},{"id":"73","coordinates":["25.0776385209476","35.30392953991176"]},{"id":"74","coordinates":["25.07774533092337","35.30389928941381"]},{"id":"75","coordinates":["25.07780810195149","35.30383879309231"]},{"id":"76","coordinates":["25.0779318206766","35.30381871667173"]},{"id":"77","coordinates":["25.07808838390259","35.30376722958181"]},{"id":"78","coordinates":["25.07803432231849","35.30383106287521"]},{"id":"79","coordinates":["25.07660335560401","35.30454623610704"]},{"id":"80","coordinates":["25.07672988749881","35.30447755414913"]},{"id":"81","coordinates":["25.07682975313575","35.30443457344097"]},{"id":"82","coordinates":["25.07692792901875","35.3043776156331"]},{"id":"83","coordinates":["25.07704537788439","35.30432842844785"]},{"id":"84","coordinates":["25.07715802844952","35.30427435457459"]},{"id":"85","coordinates":["25.07646859942897","35.3047193257112"]},{"id":"86","coordinates":["25.07655618205055","35.30468001185149"]},{"id":"87","coordinates":["25.07667360834286","35.30462961897543"]},{"id":"88","coordinates":["25.07678189364158","35.30456336999037"]},{"id":"89","coordinates":["25.07688405552036","35.30451362032594"]},{"id":"90","coordinates":["25.07654427127638","35.30517161227424"]},{"id":"91","coordinates":["25.0765039774071","35.30508856963115"]},{"id":"92","coordinates":["25.07659471565028","35.30504725280877"]},{"id":"93","coordinates":["25.07666042305665","35.30487120525505"]},{"id":"94","coordinates":["25.07661618209252","35.30476934970407"]},{"id":"95","coordinates":["25.07672140071745","35.30473555318058"]},{"id":"96","coordinates":["25.07682719049695","35.30468354672689"]},{"id":"97","coordinates":["25.07695513471855","35.30462863999046"]},{"id":"98","coordinates":["25.07698974587792","35.30447907402888"]},{"id":"99","coordinates":["25.07710171171265","35.30441405273586"]},{"id":"100","coordinates":["25.07720779880858","35.30436462701373"]},{"id":"101","coordinates":["25.07728150399014","35.30432067887042"]},{"id":"102","coordinates":["25.07725058327716","35.30421543823624"]}]


var treesGroup = group.append('g').attr('id', 'trees-group')

treesGroup
  .selectAll('circle').data(trees)
  .enter().append('circle')
  .attr('class', 'tree')
  .attr('id', function (c) { return c.id })
  .attr('r', 5)

redraw()

function redraw() {
  if (d3.event) {
    projection
        .translate(d3.event.translate)
        .scale(d3.event.scale)
  }

  // force re-projection
  group.selectAll('path').attr('d', path)

  var trees = group.selectAll('.tree')

  trees
    .attr('cx', function (c) { return projection(c.coordinates)[0] })
    .attr('cy', function (c) { return projection(c.coordinates)[1] })

  if (d3.event && d3.event.scale > 69737183) {
    treesGroup.selectAll()
  }
}


</script>
</body>
</html>
